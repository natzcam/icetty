#!/usr/bin/env node
const argv = require("yargs").argv;
const inquirer = require("inquirer");
//app
const config = require("../lib/config/client");
const client = require("../lib/client");

if (!process.stdout.isTTY) {
  console.error("Not using a terminal window");
  process.exit(-1);
}

(async () => {
  await config.setup();

  if (!argv.host) {
    const answers = await inquirer.prompt([
      {
        type: "input",
        name: "host",
        message: "Host to connect"
      }
    ]);
    argv.host = answers.host;
  }

  if (!argv.username) {
    const answers = await inquirer.prompt([
      {
        type: "input",
        name: "username",
        message: "Username?"
      }
    ]);
    argv.username = answers.username;
  }

  if (!argv.password) {
    const answers = await inquirer.prompt([
      {
        type: "password",
        name: "password",
        message: "Password?"
      }
    ]);
    argv.password = answers.password;
  }

  await client.connect(argv.host, argv.username, argv.password);
})();
